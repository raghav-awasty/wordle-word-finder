<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word of the Day Submitter</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            max-width: 600px;
            margin: 40px auto;
            padding: 20px;
            background-color: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
        }

        h1 {
            text-align: center;
        }

        label {
            display: block;
            margin-top: 15px;
            font-weight: 600;
        }

        input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
            border-radius: 6px;
            border: 1px solid #d0d7de;
        }

        button {
            width: 100%;
            padding: 10px;
            margin-top: 20px;
            background-color: #2da44e;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
        }

        button:hover {
            background-color: #2c974b;
        }

        #status {
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
        }

        .warning {
            color: #cf222e;
            font-size: 0.9em;
        }
    </style>
</head>

<body>

    <h1>Word of the Day Submitter</h1>

    <label for="word">Today's 5-Letter Word:</label>
    <input type="text" id="word" name="word" maxlength="5" pattern="[a-zA-Z]{5}" required>

    <label for="pat">GitHub Personal Access Token (PAT):</label>
    <input type="password" id="pat" name="pat" required>
    <p class="warning">
        Your PAT is used to authorize the request and is NOT stored.
        Create a <a href="https://github.com/settings/tokens/new?scopes=repo&description=Wordle%20Workflow%20Trigger"
            target="_blank" rel="noopener">new token with 'repo' scope</a>.
    </p>

    <button onclick="triggerWorkflow()">Submit Word</button>

    <div id="status"></div>

    <script>
        const GITHUB_USERNAME = "raghav-awasty";
        const GITHUB_REPO = "wordle-word-finder";
        const WORKFLOW_FILE_NAME = "update_word_otd.yml";
        const GIT_BRANCH = "main";

        async function triggerWorkflow() {
            const word = document.getElementById('word').value.toUpperCase();
            const token = document.getElementById('pat').value;
            const statusDiv = document.getElementById('status');

            if (word.length !== 5 || !/^[A-Z]+$/.test(word)) {
                statusDiv.textContent = 'Error: Please enter a valid 5-letter word.';
                statusDiv.style.color = '#cf222e';
                return;
            }
            if (!token) {
                statusDiv.textContent = 'Error: Please enter your Personal Access Token.';
                statusDiv.style.color = '#cf222e';
                return;
            }

            statusDiv.textContent = 'Triggering workflow...';
            statusDiv.style.color = '#0969da';

            const response = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/actions/workflows/${WORKFLOW_FILE_NAME}/dispatches`, {
                method: 'POST',
                headers: {
                    'Accept': 'application/vnd.github.v3+json',
                    'Authorization': `Bearer ${token}`,
                },
                body: JSON.stringify({
                    ref: GIT_BRANCH,
                    inputs: {
                        word: word
                    }
                })
            });

            if (response.ok) {
                statusDiv.textContent = `Success! Workflow triggered with word: ${word}`;
                statusDiv.style.color = '#2da44e';
            } else {
                const error = await response.json();
                statusDiv.textContent = `Error: ${error.message}`;
                statusDiv.style.color = '#cf222e';
            }
        }
    </script>
</body>

</html>